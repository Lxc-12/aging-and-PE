# ldsc 
# install.packages("devtools")
# library(devtools)
# library(R.utils)
# devtools::install_github("mglev1n/ldscr")
library(ldscr)
library(vroom)

### Genetic correlations between biological aging phenotypes and pre-eclampsia (PE)
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/PE_gwas.txt"
PE_gwas <- vroom(path, col_names = TRUE)

# Genetic correlation between biological aging acceleration (BAA) and PE 
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/BAA_gwas.txt"
BAA_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(PE_gwas,BAA_gwas), ancestry = "EUR")
BAA_h2 <- rg_res$h2
BAA_rg <- rg_res$rg

# Genetic correlation between clonal hematopoiesis of indeterminate potential (CHIP) and PE
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/CHIP_gwas.txt"
CHIP_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(PE_gwas,CHIP_gwas), ancestry = "EUR")
CHIP_h2 <- rg_res$h2
CHIP_rg <- rg_res$rg

# Genetic correlation between extrinsic epigenetic age acceleration (EEAA) and PE
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/EEAA_gwas.txt"
EEAA_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(PE_gwas,EEAA_gwas), ancestry = "EUR")
EEAA_h2 <- rg_res$h2
EEAA_rg <- rg_res$rg

# Genetic correlation between facial aging (FA) and PE
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/FA_gwas.txt"
FA_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(PE_gwas,FA_gwas), ancestry = "EUR")
FA_h2 <- rg_res$h2
FA_rg <- rg_res$rg

# Genetic correlation between frailty index (FI) and PE
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/FI_gwas.txt"
FI_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(PE_gwas,FI_gwas), ancestry = "EUR")
FI_h2 <- rg_res$h2
FI_rg <- rg_res$rg

# Genetic correlation between intrinsic epigenetic age acceleration (IEAA) and PE
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/IEAA_gwas.txt"
IEAA_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(PE_gwas,IEAA_gwas), ancestry = "EUR")
IEAA_h2 <- rg_res$h2
IEAA_rg <- rg_res$rg

# Genetic correlation between phenotypic age acceleration (PAA) and PE
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/PAA_gwas.txt"
PAA_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(PE_gwas,PAA_gwas), ancestry = "EUR")
PAA_h2 <- rg_res$h2
PAA_rg <- rg_res$rg

# Genetic correlation between telomere length (TL) and PE
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/TL_gwas.txt"
TL_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(PE_gwas,TL_gwas), ancestry = "EUR")
TL_h2 <- rg_res$h2
TL_rg <- rg_res$rg

# Estimates of heritability (h2) for the traits
PE_aging_h2 <- rbind(BAA_h2,CHIP_h2,EEAA_h2,FA_h2,FI_h2,
                     IEAA_h2,PAA_h2,TL_h2)
PE_aging_h2 <- unique(PE_aging_h2)
PE_aging_h2 <- cbind(trait=c("PE","BAA","CHIP","EEAA","FA","FI",
                             "IEAA","PAA","TL"), PE_aging_h2)
# Estimates of genetic correlation for the traits
PE_aging_corr <- rbind(BAA_rg,CHIP_rg,EEAA_rg,FA_rg,FI_rg,
                       IEAA_rg,PAA_rg,TL_rg)
PE_aging_corr$trait1 <- "PE"
PE_aging_corr$trait2 <- c("BAA","CHIP","EEAA","FA","FI","IEAA","PAA","TL")

write.csv(PE_aging_h2,
          file="F:/research/aging_PE_GTN/analysis_results/table/PE_aging_h2.csv",
          quote = FALSE, row.names = FALSE)
write.csv(PE_aging_corr,
          file="F:/research/aging_PE_GTN/analysis_results/table/PE_aging_corr.csv",
          quote = FALSE, row.names = FALSE)


### Genetic correlations between and biological aging phenotypes and gestational hypertension (GH)
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/GH_gwas.txt"
GH_gwas <- vroom(path, col_names = TRUE)

# Genetic correlation between biological aging acceleration (BAA) and GH
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/BAA_gwas.txt"
BAA_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(GH_gwas,BAA_gwas), ancestry = "EUR")
BA_h2 <- rg_res$h2
BA_rg <- rg_res$rg

# Genetic correlation between clonal hematopoiesis of indeterminate potential (CHIP) and GH
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/CHIP_gwas.txt"
CHIP_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(GH_gwas,CHIP_gwas), ancestry = "EUR")
CHIP_h2 <- rg_res$h2
CHIP_rg <- rg_res$rg

# Genetic correlation between extrinsic epigenetic age acceleration (EEAA) and GH
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/EEAA_gwas.txt"
EEAA_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(GH_gwas,EEAA_gwas), ancestry = "EUR")
EEAA_h2 <- rg_res$h2
EEAA_rg <- rg_res$rg

# Genetic correlation between facial aging (FA) and GH
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/FA_gwas.txt"
FA_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(GH_gwas,FA_gwas), ancestry = "EUR")
FA_h2 <- rg_res$h2
FA_rg <- rg_res$rg

# Genetic correlation between frailty index (FI) and GH
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/FI_gwas.txt"
FI_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(GH_gwas,FI_gwas), ancestry = "EUR")
FI_h2 <- rg_res$h2
FI_rg <- rg_res$rg

# Genetic correlation between intrinsic epigenetic age acceleration (IEAA) and GH
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/IEAA_gwas.txt"
IEAA_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(GH_gwas,IEAA_gwas), ancestry = "EUR")
IEAA_h2 <- rg_res$h2
IEAA_rg <- rg_res$rg

# Genetic correlation between phenotypic age acceleration (PAA) and GH
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/PAA_gwas.txt"
PAA_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(GH_gwas,PAA_gwas), ancestry = "EUR")
PAA_h2 <- rg_res$h2
PAA_rg <- rg_res$rg

# Genetic correlation between telomere length (TL) and GH
path <- "F:/research/aging_PE_GTN/genetic_correlation_data/TL_gwas.txt"
TL_gwas <- vroom(path, col_names = TRUE)
rg_res <- ldsc_rg(
  munged_sumstats = list(GH_gwas,TL_gwas), ancestry = "EUR")
TL_h2 <- rg_res$h2
TL_rg <- rg_res$rg

# Estimates of heritability (h2) for the traits
GH_aging_h2 <- rbind(BAA_h2,CHIP_h2,EEAA_h2,FA_h2,FI_h2,
                     IEAA_h2,PAA_h2,TL_h2)
GH_aging_h2 <- unique(GH_aging_h2)
GH_aging_h2 <- cbind(trait=c("GH","BAA","CHIP","EEAA","FA","FI",
                             "IEAA","PAA","TL"), GH_aging_h2)
# Estimates of genetic correlation (rg) for the traits
GH_aging_corr <- rbind(BAA_rg,CHIP_rg,EEAA_rg,FA_rg,FI_rg,
                       IEAA_rg,PAA_rg,TL_rg)
GH_aging_corr$trait1 <- "GH"
GH_aging_corr$trait2 <- c("BAA","CHIP","EEAA","FA","FI","IEAA","PAA","TL")

write.csv(GH_aging_h2,
          file="F:/research/aging_PE_GTN/analysis_results/table/GH_aging_h2.csv",
          quote = FALSE, row.names = FALSE)
write.csv(GH_aging_corr,
          file="F:/research/aging_PE_GTN/analysis_results/table/GH_aging_corr.csv",
          quote = FALSE, row.names = FALSE)
